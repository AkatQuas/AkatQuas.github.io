"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[3306],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>h});var a=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var p=a.createContext({}),l=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=l(e.components);return a.createElement(p.Provider,{value:t},e.children)},d="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,p=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=l(n),u=i,h=d["".concat(p,".").concat(u)]||d[u]||m[u]||r;return n?a.createElement(h,o(o({ref:t},c),{},{components:n})):a.createElement(h,o({ref:t},c))}));function h(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,o=new Array(r);o[0]=u;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s[d]="string"==typeof e?e:i,o[1]=s;for(var l=2;l<r;l++)o[l]=n[l];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},14248:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>d,frontMatter:()=>r,metadata:()=>s,toc:()=>l});var a=n(87462),i=(n(67294),n(3905));const r={title:"Micro Frontends",categories:["frontend"],tags:["frontend","mirco-frontend"]},o=void 0,s={permalink:"/blog/2021/04/11/micro-frontend",source:"@site/blog/2021-04-11-micro-frontend.md",title:"Micro Frontends",description:"Micro frontends deliver the same flexibility and maintainability to browser-based applications that microservices provide for backend systems.",date:"2021-04-11T00:00:00.000Z",formattedDate:"April 11, 2021",tags:[{label:"frontend",permalink:"/blog/tags/frontend"},{label:"mirco-frontend",permalink:"/blog/tags/mirco-frontend"}],readingTime:5.4,hasTruncateMarker:!0,authors:[],frontMatter:{title:"Micro Frontends",categories:["frontend"],tags:["frontend","mirco-frontend"]},prevItem:{title:"React Hooks Review",permalink:"/blog/2021/04/16/react-hooks-review"},nextItem:{title:"TypeScript handbook",permalink:"/blog/2021/03/27/ts-handbook"}},p={authorsImageUrls:[]},l=[{value:"Client-side integration",id:"client-side-integration",level:2},{value:"Separate pages",id:"separate-pages",level:3},{value:"Iframes",id:"iframes",level:3},{value:"Ajax",id:"ajax",level:3},{value:"Web Components",id:"web-components",level:3},{value:"Unified SPA",id:"unified-spa",level:3},{value:"Server Side Integration",id:"server-side-integration",level:2},{value:"Routing with proxy",id:"routing-with-proxy",level:3},{value:"SSI, ESI, Podium",id:"ssi-esi-podium",level:3},{value:"Universal rendering",id:"universal-rendering",level:3},{value:"Choose the architecture",id:"choose-the-architecture",level:2},{value:"Simple designed Unified SPA",id:"simple-designed-unified-spa",level:2},{value:"Structure",id:"structure",level:3},{value:"Development",id:"development",level:3},{value:"Distribution",id:"distribution",level:3},{value:"Concerns",id:"concerns",level:3},{value:"Glossary",id:"glossary",level:3},{value:"My Opinion",id:"my-opinion",level:2},{value:"References",id:"references",level:2}],c={toc:l};function d(e){let{components:t,...r}=e;return(0,i.kt)("wrapper",(0,a.Z)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Micro frontends deliver the same flexibility and maintainability to browser-based applications that microservices provide for backend systems."),(0,i.kt)("p",null,"The whole project is viewed as a set of standalone components, built upon any tech-stack or framework, with their own interfaces, logic, and storage. Then these mini-applications are evolving independently and will be composed together shipping to the browser."),(0,i.kt)("p",null,"There are several tech stacks developers can adopt to build micro frontends architecture."),(0,i.kt)("h2",{id:"client-side-integration"},"Client-side integration"),(0,i.kt)("h3",{id:"separate-pages"},"Separate pages"),(0,i.kt)("p",null,"It's also known as Multi-Page Application, MPA."),(0,i.kt)("p",null,"This is simplest and easy-implementation architecture. Every application is served as a standalone service, which produce complete server-rendered HTML documents. They are connected via ",(0,i.kt)("inlineCode",{parentName:"p"},"<a>")," tags."),(0,i.kt)("p",null,"Hard navigation among pages are triggered by clicking a link, reloading the complete page then displaying the desired content."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'\x3c!-- in app 1 --\x3e\n<div id="main-app1">\n  <div id="content">\n    \x3c!-- content provided by main-app --\x3e\n    <a href="http://link-to-app2"></a>\n  </div>\n</div>\n\n\x3c!-- in app 2 --\x3e\n<div id="main-app2">\n  <div id="content">\n    \x3c!-- content provided by main-app --\x3e\n    <a href="http://link-to-app1"></a>\n  </div>\n</div>\n')),(0,i.kt)("h3",{id:"iframes"},"Iframes"),(0,i.kt)("p",null,"Iframes allow embedding one page into another page while maintaining the same loose coupling and robustness properties that the link integration provides."),(0,i.kt)("p",null,"Iframes come with strong isolation, which means what happens in the iframe stays in the iframe. But they also have significant drawbacks, such as layout constraints, performance overhead, communication complexity, SEO confusion."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<div id="main-app">\n  <div id="content">\n    \x3c!-- content provided by main-app --\x3e\n  </div>\n  <div id="ads">\n    <iframe src="http://ads.com/{some-ads}"></iframe>\n  </div>\n</div>\n')),(0,i.kt)("h3",{id:"ajax"},"Ajax"),(0,i.kt)("p",null,"Client-side JavaScript triggers the Ajax calls to fetch server-side generated HTML snippets, and then update document dynamically and partially."),(0,i.kt)("p",null,"Be careful, ",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/API/Element/innerHTML#security_considerations"},"HTML5 specifies that a ",(0,i.kt)("inlineCode",{parentName:"a"},"<script>")," tag inserted with ",(0,i.kt)("inlineCode",{parentName:"a"},"innerHTML")," should not execute"),"."),(0,i.kt)("p",null,"Using Web Components together with Ajax for internal updating is also a good fit."),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/naltatis/micro-frontends-in-action-code/tree/master/03_ajax"},"Sample code"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"// main app\nwindow\n  .fetch('/some-url')\n  .then((res) => res.text())\n  .then((html) => {\n    document.querySelector('to-update').innerHTML = html;\n  });\n")),(0,i.kt)("h3",{id:"web-components"},"Web Components"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/Web_Components"},"Web Components")," is an umbrella term. It describes three distinct new APIs: ",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_custom_elements"},"Custom Elements"),", ",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_shadow_DOM"},"Shadow DOM"),", and ",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_templates_and_slots"},"HTML Templates"),"."),(0,i.kt)("p",null,"Web Components provides the ability to encapsulate style and business logic."),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/naltatis/micro-frontends-in-action-code/tree/master/08_web_components"},"Sample code"),", ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/naltatis/micro-frontends-in-action-code/tree/master/09_shadow_dom"},"Sample code2"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},"<div id=\"main-app\">\n  <custom-button type=\"primary\"></custom-button>\n</div>\n\n<script src=\"http://js-define-custom-button\"><\/script>\n\n\x3c!-- define the custom button --\x3e\n<script>\n  window.define(\n    'custom-button',\n    class extends HTMLElement {\n      static get observedAttributes() {\n        return ['type'];\n      }\n\n      constructor() {\n        super();\n      }\n\n      adoptedCallback() {\n        console.log('Custom button moved to new page.');\n        // using shadow DOM if necessary\n      }\n\n      disconnectedCallback() {\n        console.log('Custom button removed from page.');\n      }\n    }\n  );\n<\/script>\n")),(0,i.kt)("h3",{id:"unified-spa"},"Unified SPA"),(0,i.kt)("p",null,"The Unified SPA describes a single-page application composed of other single-page applications."),(0,i.kt)("p",null,"It requires all the components to be a single-page app, using Sveltejs, Angular, React, Vue, etc."),(0,i.kt)("p",null,"A parent application, which is often called the app shell, will unify these single-page apps into one monolithic application."),(0,i.kt)("p",null,"The app shell includes the single-spa JavaScript code and maps ",(0,i.kt)("em",{parentName:"p"},"URL prefixes")," to the code of a specific application."),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/single-spa/single-spa"},"Single SPA"),", ",(0,i.kt)("a",{parentName:"p",href:"https://ara-framework.github.io/website/"},"Ara framework"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},"<html lang=\"en\">\n  <head>\n    <title>SPA demo</title>\n    <script src=\"/single-spa-base.js\"><\/script>\n  </head>\n  <body>\n    <div id=\"app1-holder\"></div>\n    <div id=\"app2-holder\"></div>\n    <div id=\"app3-holder\"></div>\n\n    <script type=\"module\">\n      singleSpa.registerApplication(\n        'app1',\n        () => import('http://app1/pages.min.js'),\n        ({ pathname }) => pathname === '/'\n      );\n      singleSpa.registerApplication(\n        'app2',\n        () => import('http://app2/pages.min.js'),\n        ({ pathname }) => pathname.startsWith('/app2/')\n      );\n      singleSpa.registerApplication(\n        'app3',\n        () => import('http://app3/pages.min.js'),\n        ({ pathname }) => pathname.startsWith('/app3/')\n      );\n      singleSpa.start();\n    <\/script>\n  </body>\n</html>\n")),(0,i.kt)("h2",{id:"server-side-integration"},"Server Side Integration"),(0,i.kt)("h3",{id:"routing-with-proxy"},"Routing with proxy"),(0,i.kt)("p",null,"Nginx acts as a proxy and forwards the requests to the responsible services. This could be used to unify MPA architecture."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-conf"},"http {\n  upstream app1 {\n    server localhost:3001;\n  }\n\n  upstream app2 {\n    server localhost:3002;\n  }\n\n  log_format compact ':3000$uri $status';\n\n  server {\n    listen 3000;\n\n    # comment out on windows\n    access_log /dev/stdout compact;\n\n    location /app1/ {\n      proxy_pass  http://app1;\n    }\n\n    location /app2/ {\n      proxy_pass  http://app2;\n    }\n\n    location /app2-new {\n      proxy_pass  http://app2;\n    }\n  }\n}\n")),(0,i.kt)("h3",{id:"ssi-esi-podium"},"SSI, ESI, Podium"),(0,i.kt)("p",null,"This is similar to client-side integration Ajax."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-conf"},"http {\n  upstream app1 {\n    server localhost:3001;\n  }\n\n  upstream app2 {\n    server localhost:3002;\n  }\n\n  log_format compact ':3000$uri $status';\n\n  server {\n    listen 3000;\n    ssi on;\n    ; ...\n  }\n}\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<html>\n  <head>\n    <title>Main App</title>\n  </head>\n  <body>\n    <div class="content">\n      \x3c!-- ... --\x3e\n    </div>\n    <aside class="ads">\n      \x3c!--#include virtual="/app2/fragments/ads" --\x3e\n    </aside>\n  </body>\n</html>\n\n\x3c!-- app2 html fragment for ads --\x3e\n<a href="http://ad-detail">\n  <div>ads</div>\n</a>\n')),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://podium-lib.io/"},"Podium"),": Easy server side composition of microfrontends, leveraging ",(0,i.kt)("a",{parentName:"p",href:"https://expressjs.com/"},"express.js"),"."),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/naltatis/micro-frontends-in-action-code/tree/master/05_ssi"},"Sample code for SSI"),", ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/naltatis/micro-frontends-in-action-code/tree/master/07_podium"},"Sample code for Podium"),"."),(0,i.kt)("h3",{id:"universal-rendering"},"Universal rendering"),(0,i.kt)("p",null,"Universal composition is the combination of server-side and client-side composition technique."),(0,i.kt)("p",null,"For the first request, a technique like SSI, ESI, or Podium assembles the markup of all micro frontends server-side. The complete HTML document gets sent to the browser. In the browser, each micro frontend hydrates itself and becomes interactive. From there on, all user interactions can happen fully client-side. The micro frontends update the markup directly in the browser."),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://angular.io/guide/universal"},"Angular universal"),", ",(0,i.kt)("a",{parentName:"p",href:"https://nextjs.org/"},"Next.js"),"."),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/naltatis/micro-frontends-in-action-code/tree/master/16_universal"},"Sample code"),": SSI in server-side, ajax and web-component in client side."),(0,i.kt)("h2",{id:"choose-the-architecture"},"Choose the architecture"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Micro frontends architecture",src:n(89770).Z,width:"936",height:"716"})),(0,i.kt)("p",null,"The decision tree helps to pick a micro frontends architecture based on the project\u2019s requirements."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Micro frontends decision tree",src:n(96892).Z,width:"954",height:"966"})),(0,i.kt)("p",null,"These two image comes from (",(0,i.kt)("a",{parentName:"p",href:"https://codeburst.io/which-technique-architecture-is-right-for-my-project-72297e650af3"},"https://codeburst.io/which-technique-architecture-is-right-for-my-project-72297e650af3"),")."),(0,i.kt)("h2",{id:"simple-designed-unified-spa"},"Simple designed Unified SPA"),(0,i.kt)("details",null,(0,i.kt)("summary",null,"Basic mechanism: observable browser location/history, rendering path-corresponding applications."),(0,i.kt)("h3",{id:"structure"},"Structure"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"unified-spa/\n  \u251c\u2500 app-shell/\n  \u2502  \u251c\u2500 src/\n  \u2502     \u251c\u2500 index.css\n  \u2502     \u251c\u2500 index.js\n  \u2502     \u251c\u2500 index.html\n  \u2502     \u251c\u2500 layout.js\n  \u251c\u2500 parcel1/\n  \u2502  \u251c\u2500 src/\n  \u2502     \u251c\u2500 favicon.ico\n  \u2502     \u251c\u2500 index.html\n  \u2502     \u251c\u2500 index.js\n  \u251c\u2500 parcel2/\n  \u2502  \u251c\u2500 src/\n  \u2502     \u251c\u2500 image.png\n  \u2502     \u251c\u2500 index.html\n  \u2502     \u251c\u2500 index.js\n  \u251c\u2500 README.md\n  \u251c\u2500 .env\n")),(0,i.kt)("h3",{id:"development"},"Development"),(0,i.kt)("p",null,"Only the ",(0,i.kt)("inlineCode",{parentName:"p"},"app-shell")," server is running, all the other app-parcels would generate their static assets (js bundles, images, style assets) into ",(0,i.kt)("inlineCode",{parentName:"p"},"app-shell"),"'s output directory."),(0,i.kt)("h3",{id:"distribution"},"Distribution"),(0,i.kt)("p",null,"Build ",(0,i.kt)("inlineCode",{parentName:"p"},"app-shell")," first, then every ",(0,i.kt)("inlineCode",{parentName:"p"},"app-parcel"),"."),(0,i.kt)("h3",{id:"concerns"},"Concerns"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Global state."),(0,i.kt)("li",{parentName:"ul"},"Style isolation: ",(0,i.kt)("a",{parentName:"li",href:"http://getbem.com/"},"BEM"),", ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/css-modules/css-modules"},"css module"),", ",(0,i.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_shadow_DOM"},"shadow DOM"),"."),(0,i.kt)("li",{parentName:"ul"},"Communication among app-parcels: event bus, ",(0,i.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/en-US/docs/Web/API/BroadcastChannel"},"broadcast channel"),", ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/developit/mitt"},"event bus"),"."),(0,i.kt)("li",{parentName:"ul"},"Shared vendor or dependencies: unified tech stack, vendor version."),(0,i.kt)("li",{parentName:"ul"},"Assets updating: cache invalidation strategy.")),(0,i.kt)("h3",{id:"glossary"},"Glossary"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"name"),(0,i.kt)("th",{parentName:"tr",align:null},"description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"app-shell"),(0,i.kt)("td",{parentName:"tr",align:null},"app shell for layout, responsible for micro apps register/unregister")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"app-parcel"),(0,i.kt)("td",{parentName:"tr",align:null},"micro autonomous interactive applications"))))),(0,i.kt)("h2",{id:"my-opinion"},"My Opinion"),(0,i.kt)("p",null,"Micro frontends majorly focus on the ",(0,i.kt)("strong",{parentName:"p"},"integration"),". Application integrates components. Micro-frontend integrates micro-apps."),(0,i.kt)("p",null,"It's recommended to do the integration during building/distributing stage, so the end user feel little latency when using the application."),(0,i.kt)("h2",{id:"references"},"References"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("a",{parentName:"p",href:"https://www.manning.com/books/micro-frontends-in-action?a_aid=mfia&a_bid=5f09fdeb"},"Micro Frontends in Action"),": An excellent starting point to understand micro frontends. ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/naltatis/micro-frontends-in-action-code#list-of-all-examples"},"Sample code")," for this book.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"SSR: Render and update markup on the server and in the browser using single code-base. ",(0,i.kt)("a",{parentName:"p",href:"https://cdb.reacttraining.com/universal-javascript-4761051b7ae9"},"Universal JavaScript"),", ",(0,i.kt)("a",{parentName:"p",href:"https://medium.com/airbnb-engineering/isomorphic-javascript-the-future-of-web-apps-10882b7a2ebc"},"Isomorphic JavaScript")))))}d.isMDXComponent=!0},89770:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/architecture-d84ac60d956170e43b185eaa1de211fe.png"},96892:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/decision-tree-5d51790b49c370d219385def90c00fc7.png"}}]);