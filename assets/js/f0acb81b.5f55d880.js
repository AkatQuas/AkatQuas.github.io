"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[7536],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var o=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=o.createContext({}),l=function(e){var t=o.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},p=function(e){var t=l(e.components);return o.createElement(c.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},h=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,c=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=l(n),h=r,m=u["".concat(c,".").concat(h)]||u[h]||d[h]||i;return n?o.createElement(m,a(a({ref:t},p),{},{components:n})):o.createElement(m,a({ref:t},p))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,a=new Array(i);a[0]=h;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s[u]="string"==typeof e?e:r,a[1]=s;for(var l=2;l<i;l++)a[l]=n[l];return o.createElement.apply(null,a)}return o.createElement.apply(null,n)}h.displayName="MDXCreateElement"},66019:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>u,frontMatter:()=>i,metadata:()=>s,toc:()=>l});var o=n(87462),r=(n(67294),n(3905));const i={title:"Remote access",sidebar_position:10},a=void 0,s={unversionedId:"docker/remote-engine",id:"docker/remote-engine",title:"Remote access",description:"Remote access is how you administer test environments or debug issues in production, and it\u2019s also how you enable the continuous deployment part of your CI/CD pipeline. Continuous deployment is the next stage of the pipeline -- connecting to a remote Docker Engine and deploying the new version of the app.",source:"@site/docs/docker/remote-engine.md",sourceDirName:"docker",slug:"/docker/remote-engine",permalink:"/docs/docker/remote-engine",draft:!1,tags:[],version:"current",sidebarPosition:10,frontMatter:{title:"Remote access",sidebar_position:10},sidebar:"tutorialSidebar",previous:{title:"Orchestration",permalink:"/docs/docker/orchestration"},next:{title:"Security in Docker",permalink:"/docs/docker/security"}},c={},l=[{value:"Endpoint options for the Docker API",id:"endpoint-options-for-the-docker-api",level:3},{value:"Configuring Docker for secure remote access",id:"configuring-docker-for-secure-remote-access",level:3},{value:"Using Docker Contexts to work with remote engines",id:"using-docker-contexts-to-work-with-remote-engines",level:3},{value:"Adding continuous deployment to the CI pipeline",id:"adding-continuous-deployment-to-the-ci-pipeline",level:3},{value:"Understanding teh access model for Docker",id:"understanding-teh-access-model-for-docker",level:3}],p={toc:l};function u(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,o.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Remote access is how you administer test environments or debug issues in production, and it\u2019s also how you enable the ",(0,r.kt)("em",{parentName:"p"},"continuous deployment")," part of your CI/CD pipeline. Continuous deployment is the next stage of the pipeline -- connecting to a remote Docker Engine and deploying the new version of the app."),(0,r.kt)("h3",{id:"endpoint-options-for-the-docker-api"},"Endpoint options for the Docker API"),(0,r.kt)("p",null,"The default setup is for the Engine to listen on a local channel, and for the command line to use that same channel. The local channel uses either Linux ",(0,r.kt)("em",{parentName:"p"},"sockets")," or Windows named ",(0,r.kt)("em",{parentName:"p"},"pipes"),", and those are both network technologies that restrict traffic to the local machine."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "hosts": [\n    // enable remote access on port 2375\n    "tcp://0.0.0.0:2375"\n    // keep listening on the local channel, Linux socket\n    "fd://"\n    // keep listening on the local channel, Windows pipe\n    "npipe://"\n  ],\n  "insecure-registries": [\n    "https://hub-mirror.c.163.com/"\n  ]\n}\n')),(0,r.kt)("p",null,"The Docker and Docker Compose command lines both support a ",(0,r.kt)("inlineCode",{parentName:"p"},"host")," parameter, which specifies the address of the Docker Engine where you want to send commands."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"docker --host tcp://localhost:2375 image ls\n\ncurl http://localhost:2375/containers/json\n")),(0,r.kt)("p",null,"When you\u2019re working with a remote Docker Engine, any commands you send work in the context of that machine. So if you run a container and mount a volume from ",(0,r.kt)("em",{parentName:"p"},"the local disk"),", it\u2019s the ",(0,r.kt)("em",{parentName:"p"},"remote machine\u2019s disk")," that the container sees."),(0,r.kt)("h3",{id:"configuring-docker-for-secure-remote-access"},"Configuring Docker for secure remote access"),(0,r.kt)("p",null,"Docker supports two other channels for the API to listen on, and both are secure."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Transport Layer Security (TLS): the same encryption technique based on digital certificates used by HTTPS websites. The Docker API uses ",(0,r.kt)("em",{parentName:"p"},"mutual TLS"),", so the server has a certificate to identify itself and encrypt traffic, and the client also has a certificate to identify itself.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Secure Shell (SSH) protocol: it is the standard way to connect to Linux servers, but it is also supported in Windows. SSH users can authenticate with username and password or with private keys."))),(0,r.kt)("h3",{id:"using-docker-contexts-to-work-with-remote-engines"},"Using Docker Contexts to work with remote engines"),(0,r.kt)("p",null,"You can point your local Docker CLI to a remote machine using the ",(0,r.kt)("inlineCode",{parentName:"p"},"host")," parameter, along with all the TLS cert paths if you\u2019re using a secured channel, but it\u2019s awkward to do that for every command you run. Docker makes it easier to switch between Docker Engines using Contexts."),(0,r.kt)("p",null,"You create a Docker Context using the CLI, specifying all the connection details for the Engine. You can create multiple contexts, and all the connection details for each context are stored on your local machine."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'# create a context using your PWD domain and certs:\ndocker context create pwd-tls --docker "host=tcp://$pwdDomain,ca=/tmp/pwd-certs/ca.pem,cert=/tmp/pwd-certs/client-cert.pem,key=/tmp/pwd-certs/client-key.pem"\n\n# for SSH it would be:\ndocker context create local-tls --docker "host=ssh://user@server"\n\n# list contexts:\ndocker context ls\n\n# switch contexts, system-wide default,\ndocker context use CONTEXT\n\n# using context in current terminal session, temporarily\nexport DOCKER_CONTEXT=\'some-context\'\n')),(0,r.kt)("h3",{id:"adding-continuous-deployment-to-the-ci-pipeline"},"Adding continuous deployment to the CI pipeline"),(0,r.kt)("p",null,"That pipeline covered the continuous integration (CI) stages\u2014building and testing the app in containers and pushing the built image to a Docker registry. The continuous Deployment (CD) stages add to that, deploying to a testing environment for final signoff and then to production."),(0,r.kt)("p",null,"Most automation servers let you store secrets inside the build server and use them in pipeline jobs, and that separates credential management from source control."),(0,r.kt)("h3",{id:"understanding-teh-access-model-for-docker"},"Understanding teh access model for Docker"),(0,r.kt)("p",null,"Securing your Engine is about two things: encrypting the traffic between the CLI and API, and authenticating to ensure the user is allowed access to the API."),(0,r.kt)("p",null,"There\u2019s no authorization\u2014the access model is all or nothing. If you can't connect to the API, you can't do anything, and if you can connect to the API, you can do everything."),(0,r.kt)("p",null,"Kubernetes has a role-based access control model, as does Docker Enterprise, so you can restrict which users can access resources, and what they can do with those resources."))}u.isMDXComponent=!0}}]);